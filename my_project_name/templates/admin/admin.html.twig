{% extends 'base.html.twig' %}

{% block title %}Hello AdminController!{% endblock %}

{% block body %}

    <h1 class="text-center py-5">Hello {{app.user.name}}</h1>
    <nav>
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <a class="nav-item nav-link active" id="nav-signalement-tab" data-toggle="tab" href="#nav-signalement" role="tab" aria-controls="nav-home" aria-selected="true">Signalements</a>
          <a class="nav-item nav-link" id="nav-bannis-tab" data-toggle="tab" href="#nav-bannis" role="tab" aria-controls="nav-profile" aria-selected="false">Les bannis</a>
          <a class="nav-item nav-link" id="nav-statistique-tab" href="{{path('admin_stat')}}" role="tab" aria-controls="nav-profile" aria-selected="false">Statistiques</a>
        </div>
    </nav>
    <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="nav-signalement"role="tabpanel" aria-labelledby="nav-signalement-tab">
            <h2 class="py-3">Les signalements:</h2>
    
            <!-- affichage des annonces -->
            <h3 class="text-center my-5">Les annonces</h3>
            {% for signalements in signalements_annonces %}
                    <div class="border bg-warning rounded p-2 my-2">
                        <div class="p-2">
                            <h4 class="border-bottom">{{signalements[0].annonce.titre}}</h4>
                            <h5>Motif:</h5>
                            {% for signalement in signalements %}
                                <p>{{signalement.message}}</p>
                            {% endfor %}
                            <div class="row px-2">
                                <a href="{{path('annonce', {id: signalements[0].annonce.id})}}" class="btn btn-info col-sm-4 col-md-2 mx-1">Voir l'annonce --></a>
                                <a href="{{path('admin', {id: signalements[0].annonce.id, action: "ok", cible: "annonce"})}}" class="btn btn-success col-sm-4 col-md-2 mx-1">C'est ok</a>
                                <a href="{{path('admin', {id: signalements[0].annonce.id, action: "delete", cible: "annonce"})}}" class="btn btn-danger col-sm-4 col-md-2 mx-1">Supprimer</a>
                            </div>
                        </div>
                    </div>
            {% endfor %}

            <!-- affichage des utilisateur -->
            <h3 class="text-center my-5">Les utilisateurs</h3>
            {% for signalements in signalements_user %}
            
                    <div class="border bg-warning rounded p-2 my-2">
                        <div class="p-2">
                            <h4 class="border-bottom">{{signalements[0].user.name}} {{signalements[0].user.lastname}}</h4>
                            <h5>Motif:</h5>
                            {% for signalement in signalements %}
                                <p>{{signalement.message}}</p>
                            {% endfor %}
                            <div class="row px-2">
                                <a href="{{path('mon_compte', {id: signalements[0].user.id})}}" class="btn btn-info col-sm-4 col-md-2 mx-1">Voir le profil --></a>
                                <a href="{{path('admin', {id: signalements[0].user.id, action: "ok", cible: "user"})}}" class="btn btn-success col-sm-4 col-md-2 mx-1">C'est ok</a>
                                <a href="{{path('admin', {id: signalements[0].user.id, action: "delete", cible: "user"})}}" class="btn btn-danger col-sm-4 col-md-2 mx-1">Bannir</a>
                            </div>
                        </div>
                    </div>
            {% endfor %}
        </div>
        <!-- Les bannis -->
        <div class="tab-pane fade" id="nav-bannis"role="tabpanel" aria-labelledby="nav-bannis-tab">
            <h2 class="py-3">Les Bannis</h2>
            {% for banni in bannis %}
            <div class="row">
                <p><b>{{banni.name}} {{banni.lastname}}</b> </p>
                <a href="{{path('admin', {id: banni.id, action: 'debann'})}}" class="text-danger ml-2">RÃ©activer le compte</a>
            </div>
            {% endfor %}  
        </div>
    </div>
{% endblock %}
